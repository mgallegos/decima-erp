var $jscomp={scope:{},findInternal:function(d,p,l){d instanceof String&&(d=String(d));for(var r=d.length,v=0;v<r;v++){var m=d[v];if(p.call(l,m,v,d))return{i:v,v:m}}return{i:-1,v:void 0}}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(d,p,l){if(l.get||l.set)throw new TypeError("ES3 does not support getters and setters.");d!=Array.prototype&&d!=Object.prototype&&(d[p]=l.value)};
$jscomp.getGlobal=function(d){return"undefined"!=typeof window&&window===d?d:"undefined"!=typeof global&&null!=global?global:d};$jscomp.global=$jscomp.getGlobal(this);$jscomp.polyfill=function(d,p,l,r){if(p){l=$jscomp.global;d=d.split(".");for(r=0;r<d.length-1;r++){var v=d[r];v in l||(l[v]={});l=l[v]}d=d[d.length-1];r=l[d];p=p(r);p!=r&&null!=p&&$jscomp.defineProperty(l,d,{configurable:!0,writable:!0,value:p})}};
$jscomp.polyfill("Array.prototype.find",function(d){return d?d:function(d,l){return $jscomp.findInternal(this,d,l).v}},"es6-impl","es3");
(function(d){"function"===typeof define&&define.amd?define(["jquery","./grid.base"],d):"object"===typeof exports?d(require("jquery")):d(jQuery)})(function(d){var p=d.jgrid,l=p.getAccessor,r=p.stripPref,v=p.jqID,m=d.fn.jqGrid,x=function(){var a=d.makeArray(arguments);a[0]="treeGrid"+a[0].charAt(0).toUpperCase()+a[0].substring(1);a.unshift("");a.unshift("");a.unshift(this.p);return p.feedback.apply(this,a)};p.extend({setTreeNode:function(){return this.each(function(){var a=d(this),b=this.p;if(this.grid&&
b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.leaf_field;a.off("jqGridBeforeSelectRow.setTreeNode");a.on("jqGridBeforeSelectRow.setTreeNode",function(f,k,e){if(null!=e){f=d(e.target);e=f.closest("tr.jqgrow>td");var h=e.parent(),t=function(){var d=b.data[b._index[r(b.idPrefix,k)]],e=d[c]?"collapse":"expand";d[g]||(m[e+"Row"].call(a,d,h),m[e+"Node"].call(a,d,h))};f.is("div.treeclick")?t():b.ExpandColClick&&0<e.length&&0<f.closest("span.cell-wrapper",e).length&&t();return!0}})}})},setTreeGrid:function(){return this.each(function(){var a=
this.p,b,c,g,f=[],k=["leaf_field","expanded_field","loaded"];if(a.treeGrid){a.treedatatype||d.extend(this.p,{treedatatype:a.datatype});a.subGrid=!1;a.altRows=!1;a.pgbuttons=!1;a.pginput=!1;a.gridview=!0;null===a.rowTotal&&(a.rowNum=a.maxRowNum);a.rowList=[];a.treeIcons.plus="rtl"===a.direction?a.treeIcons.plusRtl:a.treeIcons.plusLtr;"nested"===a.treeGridModel?a.treeReader=d.extend({level_field:"level",left_field:"lft",right_field:"rgt",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",
icon_field:"icon"},a.treeReader):"adjacency"===a.treeGridModel&&(a.treeReader=d.extend({level_field:"level",parent_id_field:"parent",leaf_field:"isLeaf",expanded_field:"expanded",loaded:"loaded",icon_field:"icon"},a.treeReader));for(c in a.colModel)if(a.colModel.hasOwnProperty(c))for(g in b=a.colModel[c].name,a.treeReader)a.treeReader.hasOwnProperty(g)&&a.treeReader[g]===b&&f.push(b);d.each(a.treeReader,function(b){var c=String(this);c&&-1===d.inArray(c,f)&&(0<=d.inArray(b,k)?a.additionalProperties.push({name:c,
search:!1,convert:function(a){return!0===a||"true"===String(a).toLowerCase()||"1"===String(a)?!0:a}}):a.additionalProperties.push(c))})}})},expandRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,f=a[c.localReader.id];if(x.call(this,"beforeExpandRow",{rowid:f,item:a})){var k=m.getNodeChildren.call(b,a);d(k).each(function(){var a=c.idPrefix+l(this,c.localReader.id);d(m.getGridRowById.call(b,a)).css("display","");this[g]&&m.expandRow.call(b,
this)});x.call(this,"afterExpandRow",{rowid:f,item:a})}}})},collapseRow:function(a){this.each(function(){var b=d(this),c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.expanded_field,f=a[c.localReader.id];if(x.call(this,"beforeCollapseRow",{rowid:f,item:a})){var k=m.getNodeChildren.call(b,a);d(k).each(function(){var a=c.idPrefix+l(this,c.localReader.id);d(m.getGridRowById.call(b,a)).css("display","none");this[g]&&m.collapseRow.call(b,this)});x.call(this,"afterCollapseRow",{rowid:f,item:a})}}})},
getRootNodes:function(){var a=[];this.each(function(){var b=this.p;if(this.grid&&b.treeGrid)switch(b.treeGridModel){case "nested":var c=b.treeReader.level_field;d(b.data).each(function(){parseInt(this[c],10)===parseInt(b.tree_root_level,10)&&a.push(this)});break;case "adjacency":var g=b.treeReader.parent_id_field;d(b.data).each(function(){null!==this[g]&&"null"!==String(this[g]).toLowerCase()||a.push(this)})}});return a},getNodeDepth:function(a){var b=null;this.each(function(){var c=this.p;if(this.grid&&
c.treeGrid)switch(c.treeGridModel){case "nested":b=parseInt(a[c.treeReader.level_field],10)-parseInt(c.tree_root_level,10);break;case "adjacency":b=m.getNodeAncestors.call(d(this),a).length}});return b},getNodeParent:function(a){var b=this[0];if(!b||!b.grid||null==b.p||!b.p.treeGrid||null==a)return null;var b=b.p,c=b.treeReader,g=a[c.parent_id_field];if("nested"===b.treeGridModel){var f=null,k=c.left_field,e=c.right_field,h=c.level_field,t=parseInt(a[k],10),m=parseInt(a[e],10),n=parseInt(a[h],10);
d(b.data).each(function(){if(parseInt(this[h],10)===n-1&&parseInt(this[k],10)<t&&parseInt(this[e],10)>m)return f=this,!1});return f}if(null===g||"null"===g)return null;a=b._index[g];return void 0!==a?b.data[a]:null},getNodeChildren:function(a){var b=[];this.each(function(){var c=this.p;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var g=c.treeReader.left_field,f=c.treeReader.right_field,k=c.treeReader.level_field,e=parseInt(a[g],10),h=parseInt(a[f],10),m=parseInt(a[k],10);d(c.data).each(function(){parseInt(this[k],
10)===m+1&&parseInt(this[g],10)>e&&parseInt(this[f],10)<h&&b.push(this)});break;case "adjacency":var B=c.treeReader.parent_id_field,n=c.localReader.id;d(c.data).each(function(){String(this[B])===String(a[n])&&b.push(this)})}});return b},getFullTreeNode:function(a){var b=[];this.each(function(){var c=this.p,g;if(this.grid&&c.treeGrid)switch(c.treeGridModel){case "nested":var f=c.treeReader.left_field,k=c.treeReader.right_field,e=c.treeReader.level_field,h=parseInt(a[f],10),m=parseInt(a[k],10),B=parseInt(a[e],
10);d(c.data).each(function(){parseInt(this[e],10)>=B&&parseInt(this[f],10)>=h&&parseInt(this[f],10)<=m&&b.push(this)});break;case "adjacency":if(a){b.push(a);var n=c.treeReader.parent_id_field,p=c.localReader.id;d(c.data).each(function(){var a;g=b.length;for(a=0;a<g;a++)if(String(b[a][p])===String(this[n])){b.push(this);break}})}}});return b},getNodeAncestors:function(a){var b=[];this.each(function(){var c=d(this),g=m.getNodeParent;if(this.grid&&this.p.treeGrid)for(var f=g.call(c,a);f;)b.push(f),
f=g.call(c,f)});return b},isVisibleNode:function(a){var b=!0;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=m.getNodeAncestors.call(d(this),a),f=c.treeReader.expanded_field;d(g).each(function(){b=b&&this[f];if(!b)return!1})}});return b},isNodeLoaded:function(a){var b;this.each(function(){var c=this.p;if(this.grid&&c.treeGrid){var g=c.treeReader.leaf_field,c=c.treeReader.loaded;b=void 0!==a?void 0!==a[c]?a[c]:a[g]||0<m.getNodeChildren.call(d(this),a).length?!0:!1:!1}});return b},
expandNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field,g=b.treeReader.parent_id_field,f=b.treeReader.loaded,k=b.treeReader.level_field,e=b.treeReader.left_field,h=b.treeReader.right_field;if(!a[c]){var t=l(a,b.localReader.id);if(x.call(this,"beforeExpandNode",{rowid:t,item:a})){var p=d("#"+b.idPrefix+v(t),this.grid.bDiv)[0],n=b._index[t];"local"===b.treedatatype||m.isNodeLoaded.call(d(this),b.data[n])?(a[c]=!0,d("div.treeclick",
p).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus")):this.grid.hDiv.loading||(a[c]=!0,d("div.treeclick",p).removeClass(b.treeIcons.plus+" tree-plus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.minus+" tree-minus"),b.treeANode=p.rowIndex,b.datatype=b.treedatatype,m.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:t,n_level:a[k],n_left:a[e],n_right:a[h]}:{nodeid:t,n_level:a[k],parentid:a[g]}}),
d(this).trigger("reloadGrid"),a[f]=!0,m.setGridParam.call(d(this),{postData:"nested"===b.treeGridModel?{nodeid:"",n_level:"",n_left:"",n_right:""}:{nodeid:"",n_level:"",parentid:""}}));x.call(this,"afterExpandNode",{rowid:t,item:a})}}}})},collapseNode:function(a){return this.each(function(){var b=this.p;if(this.grid&&b.treeGrid){var c=b.treeReader.expanded_field;if(a[c]){var g=l(a,b.localReader.id);if(x.call(this,"beforeCollapseNode",{rowid:g,item:a})){a[c]=!1;d("#"+b.idPrefix+v(g),this.grid.bDiv).find("div.treeclick").removeClass(b.treeIcons.minus+
" tree-minus").addClass(b.treeIcons.commonIconClass).addClass(b.treeIcons.plus+" tree-plus");if(!0===b.unloadNodeOnCollapse||d.isFunction(b.unloadNodeOnCollapse)&&b.unloadNodeOnCollapse.call(this,a))a[b.treeReader.loaded]=!1,d(this).jqGrid("delTreeNode",g,!0);x.call(this,"afterCollapseNode",{rowid:g,item:a})}}}})},SortTree:function(a,b,c,g){return this.each(function(){var f=this,k=f.p,e=d(f);if(f.grid&&k.treeGrid){var h,t,B,n=[];h=m.getRootNodes.call(e);h=p.from.call(f,h);h.orderBy(a,b,c,g);var r=
h.select();h=0;for(t=r.length;h<t;h++)B=r[h],n.push(B),m.collectChildrenSortTree.call(e,n,B,a,b,c,g);d.each(n,function(a){var b=l(this,k.localReader.id);d(f.rows[a]).after(e.find(">tbody>tr#"+v(b)))})}})},collectChildrenSortTree:function(a,b,c,g,f,k){return this.each(function(){var e=d(this);if(this.grid&&this.p.treeGrid){var h,t,l;h=m.getNodeChildren.call(e,b);h=p.from.call(this,h);h.orderBy(c,g,f,k);var n=h.select();h=0;for(t=n.length;h<t;h++)l=n[h],a.push(l),m.collectChildrenSortTree.call(e,a,
l,c,g,f,k)}})},setTreeRow:function(a,b){var c=!1;this.each(function(){this.grid&&this.p.treeGrid&&(c=m.setRowData.call(d(this),a,b))});return c},delTreeNode:function(a,b){return this.each(function(){var c=this.p,g,f,k,e;k=c.localReader.id;var h,t=d(this),l=c.treeReader.left_field,n=c.treeReader.right_field;if(this.grid&&c.treeGrid&&(h=c._index[a],void 0!==h)){g=parseInt(c.data[h][n],10);f=g-parseInt(c.data[h][l],10)+1;var r=m.getFullTreeNode.call(t,c.data[h]);if(0<r.length)for(h=0;h<r.length;h++)b&&
a===r[h][k]||m.delRowData.call(t,r[h][k]);if("nested"===c.treeGridModel){k=p.from.call(this,c.data).greater(l,g,{stype:"integer"}).select();if(k.length)for(e in k)k.hasOwnProperty(e)&&(k[e][l]=parseInt(k[e][l],10)-f);k=p.from.call(this,c.data).greater(n,g,{stype:"integer"}).select();if(k.length)for(e in k)k.hasOwnProperty(e)&&(k[e][n]=parseInt(k[e][n],10)-f)}}})},addChildNode:function(a,b,c,g){var f=d(this),k=f[0],e=k.p,h=m.getInd;if(c){var l,r,n,v,y;l=0;var x=b,E,w,C=e.treeReader.expanded_field;
w=e.treeReader.leaf_field;var q=e.treeReader.level_field,K=e.treeReader.parent_id_field,A=e.treeReader.left_field,z=e.treeReader.right_field,F=e.treeReader.loaded;void 0===g&&(g=!1);if(null==a){y=e.data.length-1;if(0<=y)for(;0<=y;)l=Math.max(l,parseInt(e.data[y][e.localReader.id],10)),y--;a=l+1}var J=h.call(f,b);E=!1;if(void 0===b||null===b||""===b)x=b=null,l="last",v=e.tree_root_level,y=e.data.length+1;else{l="after";r=e._index[b];n=e.data[r];b=n[e.localReader.id];y=h.call(f,b);v=parseInt(n[q],10)+
1;var G=m.getFullTreeNode.call(f,n);if(G.length){var D,H,I;for(D=0;D<G.length;D++)I=G[D][e.localReader.id],H=h.call(f,I),H>y&&(y=H,x=I)}y++;n[w]&&(E=!0,n[C]=!0,d(k.rows[J]).find("span.cell-wrapperleaf").removeClass("cell-wrapperleaf").addClass("cell-wrapper").end().find("div.tree-leaf").removeClass(e.treeIcons.leaf+" tree-leaf").addClass(e.treeIcons.commonIconClass).addClass(e.treeIcons.minus+" tree-minus"),e.data[r][w]=!1,n[F]=!0)}h=y+1;void 0===c[C]&&(c[C]=!1);void 0===c[F]&&(c[F]=!1);c[q]=v;void 0===
c[w]&&(c[w]=!0);"adjacency"===e.treeGridModel&&(c[K]=b);if("nested"===e.treeGridModel){var u;if(null!==b){w=parseInt(n[z],10);e=p.from.call(k,e.data);e=e.greaterOrEquals(z,w,{stype:"integer"});q=e.select();if(q.length)for(u in q)q.hasOwnProperty(u)&&(q[u][A]=q[u][A]>w?parseInt(q[u][A],10)+2:q[u][A],q[u][z]=q[u][z]>=w?parseInt(q[u][z],10)+2:q[u][z]);c[A]=w;c[z]=w+1}else{w=parseInt(m.getCol.call(f,z,!1,"max"),10);q=p.from.call(k,e.data).greater(A,w,{stype:"integer"}).select();if(q.length)for(u in q)q.hasOwnProperty(u)&&
(q[u][A]=parseInt(q[u][A],10)+2);q=p.from.call(k,e.data).greater(z,w,{stype:"integer"}).select();if(q.length)for(u in q)q.hasOwnProperty(u)&&(q[u][z]=parseInt(q[u][z],10)+2);c[A]=w+1;c[z]=w+2}}if(null===b||m.isNodeLoaded.call(f,n)||E)m.addRowData.call(f,a,c,l,x),m.setTreeNode.call(f,y,h);n&&!n[C]&&g&&d(k.rows[J]).find("div.treeclick").click()}}})});
//# sourceMappingURL=grid.treegrid.map
